## -*- mode: makefile -*-

## 
## This file is part of the Score-P software (http://www.score-p.org)
##
## Copyright (c) 2009-2011, 
##    RWTH Aachen University, Germany
##    Gesellschaft fuer numerische Simulation mbH Braunschweig, Germany
##    Technische Universitaet Dresden, Germany
##    University of Oregon, Eugene, USA
##    Forschungszentrum Juelich GmbH, Germany
##    German Research School for Simulation Sciences GmbH, Juelich/Aachen, Germany
##    Technische Universitaet Muenchen, Germany
##
## See the COPYING file in the package base directory for details.
##

# Common settings

libscorep_adapter_compiler_la_CPPFLAGS = $(AM_CPPFLAGS)      \
    -I$(INC_DIR_UTIL)                                        \
    -I$(PUBLIC_INC_DIR)                                      \
    -I$(INC_ROOT)src/adapters/compiler                       \
    -I$(INC_ROOT)src/adapters/include                        \
    -I$(INC_ROOT)src/measurement/include

noinst_LTLIBRARIES += libscorep_adapter_compiler.la

libscorep_adapter_compiler_la_SOURCES =                         \
	$(SRC_ROOT)src/adapters/include/SCOREP_Compiler_Init.h  \
	$(SRC_ROOT)src/adapters/compiler/scorep_compiler_data.h \
	$(SRC_ROOT)src/adapters/compiler/scorep_compiler_data.c


# intel specific settings

if SCOREP_COMPILER_INTEL
if HAVE_LIBBFD
libscorep_adapter_compiler_la_CPPFLAGS += -DHAVE_LIBBFD
endif
if HAVE_DEMANGLE
libscorep_adapter_compiler_la_CPPFLAGS += -DGNU_DEMANGLE
endif
libscorep_adapter_compiler_la_CPPFLAGS += -DINTEL_COMPILER

if HAVE_NM_AS_BFD_REPLACEMENT
libscorep_adapter_compiler_la_CPPFLAGS += \
	-I$(INC_ROOT)src/services/include \
        -DHAVE_NM

libscorep_adapter_compiler_la_SOURCES  += \
	$(SRC_ROOT)src/services/include/SCOREP_Timing.h
endif

libscorep_adapter_compiler_la_SOURCES +=                                \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c         \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_symbol_table.c \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_symbol_table.h \
	$(SRC_ROOT)src/adapters/compiler/scorep_compiler_intel.c
endif 

#ibm specific settings

if SCOREP_COMPILER_IBM
libscorep_adapter_compiler_la_SOURCES +=                        \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_ibm.c
endif

# pgi specific settings

if SCOREP_COMPILER_PGI
libscorep_adapter_compiler_la_SOURCES +=                        \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_pgi.c  \
        $(SRC_ROOT)src/measurement/include/SCOREP_Thread_Types.h
endif

# gnu specific settings

if SCOREP_COMPILER_GNU
if HAVE_LIBBFD
libscorep_adapter_compiler_la_CPPFLAGS += -DHAVE_LIBBFD
endif
if HAVE_DEMANGLE
libscorep_adapter_compiler_la_CPPFLAGS += -DGNU_DEMANGLE
endif 

if HAVE_NM_AS_BFD_REPLACEMENT
libscorep_adapter_compiler_la_CPPFLAGS += \
	-I$(INC_ROOT)src/services/include \
        -DHAVE_NM

libscorep_adapter_compiler_la_SOURCES  += \
	$(SRC_ROOT)src/services/include/SCOREP_Timing.h
endif

libscorep_adapter_compiler_la_SOURCES +=                                \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c         \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_symbol_table.c \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_symbol_table.h \
	$(SRC_ROOT)src/adapters/compiler/scorep_compiler_gnu.c
endif

# sx specific settings

if SCOREP_COMPILER_SX
libscorep_adapter_compiler_la_SOURCES +=                          \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c   \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_ftrace.c \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_ftrace_1.s
endif

# sun specific settings

if SCOREP_COMPILER_SUN
 libscorep_adapter_compiler_la_SOURCES += \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c         \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_sun.c
endif

# hp specific settings

#if SCOREP_COMPILER_HP
# libscorep_adapter_compiler_la_SOURCES += \
#    $(SRC_ROOT)src/adapters/compiler/scorep_compiler_hp.c
#endif

# If no compiler adapter is available
if !SCOREP_COMPILER_INTEL 
if !SCOREP_COMPILER_IBM 
if !SCOREP_COMPILER_PGI 
if !SCOREP_COMPILER_GNU 
if !SCOREP_COMPILER_SX
if !SCOREP_COMPILER_SUN
libscorep_adapter_compiler_la_SOURCES +=                                \
        $(SRC_ROOT)src/adapters/compiler/SCOREP_Compiler_Init.c         \
        $(SRC_ROOT)src/adapters/compiler/scorep_compiler_empty.c
endif
endif
endif
endif
endif
endif

